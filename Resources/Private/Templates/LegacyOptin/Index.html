{namespace sg=SGalinski\SgCookieOptin\ViewHelpers\Legacy}

<f:layout name="Legacy/Default" />

<f:section name="content">
	<f:if condition="{isSiteRoot}">
		<f:then>
			<h1><f:translate key="backend.moduleHeader" /></h1>
			<p><f:translate key="backend.moduleDescription" /></p>
			<f:flashMessages />

			<f:if condition="{pageUid}">
				<f:if condition="{isSiteRoot}">
					<f:if condition="{optins -> f:count()} <= 0">
						<div class="form-group">
							<f:if condition="{sg:backend.isVersionHigherThan(version: '10.0.0')}">
								<f:then>
									<f:link.action action="create" class="btn btn-default form-group ">
										<span class="t3js-icon icon icon-size-small icon-state-default icon-actions-document-new" data-identifier="actions-document-new">
											<span class="icon-markup">
												<svg class="icon-color" role="img"><use xlink:href="/typo3/sysext/core/Resources/Public/Icons/T3Icons/sprites/actions.svg#actions-document-add"></use></svg>
											</span>
										</span>
										<f:translate key="backend.createRecord" />
									</f:link.action>
								</f:then>
								<f:else>
									<f:if condition="{sg:backend.isVersionHigherThan(version: '9.0.0')}">
										<f:then>
											<f:link.action action="create" class="btn btn-default form-group ">
												<span class="t3js-icon icon icon-size-small icon-state-default icon-actions-document-new">
													<span class="icon-markup">
														<img src="/typo3/sysext/core/Resources/Public/Icons/T3Icons/actions/actions-document-new.svg" width="16" height="16">
													</span>
												</span>
												<f:translate key="backend.createRecord" />
											</f:link.action>
										</f:then>
										<f:else>
											<a href="#" class="btn btn-default form-group" onclick="{sg:backend.editOnClick(table: 'tx_sgcookieoptin_domain_model_optin', uid: pageUid, new: 1)}">
												<span class="t3js-icon icon icon-size-small icon-state-default icon-actions-document-new">
													<span class="icon-markup">
														<img src="/typo3/sysext/core/Resources/Public/Icons/T3Icons/actions/actions-document-new.svg" width="16" height="16">
													</span>
												</span>
												<f:translate key="backend.createRecord" />
											</a>
										</f:else>
									</f:if>
								</f:else>
							</f:if>
						</div>
					</f:if>
				</f:if>
			</f:if>

			<f:if condition="{optins}">
				<div class="panel panel-default recordlist">
					<div class="table-fit">
						<table data-table="tx_sgcookieoptin_domain_model_optin" class="table table-striped table-hover">
							<tbody>
							<f:for each="{optins}" as="optin">
								<tr data-uid="{optin.uid}">
									<td nowrap="nowrap" class="col-icon">
										<f:format.raw><sg:backend.icon table="tx_sgcookieoptin_domain_model_optin" row="{optin}" /></f:format.raw>
									</td>

									<td nowrap="nowrap">
										<a href="#" onclick="{sg:backend.editOnClick(table: 'tx_sgcookieoptin_domain_model_optin', uid: optin.uid)}">
											<span>{optin.header}</span>
										</a>
									</td>

									<td nowrap="nowrap" class="col-control">
										<f:format.raw><sg:backend.control table="tx_sgcookieoptin_domain_model_optin" row="{optin}" /></f:format.raw>
									</td>
								</tr>
							</f:for>
							</tbody>
						</table>
					</div>
				</div>
			</f:if>

			<f:if condition="{licenseTitle}">
				<div class="typo3-messages">
					<f:if condition="{licenseError} == '0'">
						<f:then><div class="alert alert-info"></f:then>
						<f:else>
							<f:if condition="{licenseError} == '1'">
								<f:then>
									<div class="alert alert-danger">
								</f:then>
								<f:else>
									<f:if condition="{licenseError} == '2'"><div class="alert alert-warning"></f:if>
								</f:else>
							</f:if>
						</f:else>
					</f:if>
						<div class="media">
							<div class="media-left">
								<span class="fa-stack fa-lg">
									<i class="fa fa-circle fa-stack-2x"></i>
									<f:if condition="{licenseError} == '1'">
										<f:then><i class="fa fa-times fa-stack-1x"></i></f:then>
										<f:else><i class="fa fa-info fa-stack-1x"></i></f:else>
									</f:if>

								</span>
							</div>
							<div class="media-body">
								<h4 class="alert-title">{licenseTitle}</h4>
								<p class="alert-message">{licenseMessage}</p>
							</div>
						</div>
					</div>
				</div>
			</f:if>

			<div class="typo3-messages">
				<div class="alert">
					<div class="media">
						<div class="media-left">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-info fa-stack-1x"></i>
							</span>
						</div>
						<div class="media-body">
							<h4 class="alert-title"><f:translate key="backend.addScripts" /></h4>
							<p><f:translate key="backend.toolForCookies" /> <a class="btn btn-default btn-sm text-decoration-none" href="https://www.cookieserve.com/" target="_blank"><f:translate key="backend.toolForCookies.button" /></a></p>
						</div>
					</div>
				</div>
			</div>

			<div class="typo3-messages">
				<div class="alert">
					<div class="media">
						<div class="media-left">
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-info fa-stack-1x"></i>
							</span>
						</div>
						<div class="media-body">
							<h4 class="alert-title"><f:translate key="backend.addContentElementToDataPrivacy" /></h4>
							<p class="alert-message"><f:translate key="backend.addOpenUpLinkToDataPrivacy" /></p>
						</div>
					</div>
				</div>
			</div>
		</f:then>
		<f:else>
			<f:flashMessages />
			<f:if condition="{pages}">
				<f:then>
					<h3>{f:translate(key:'backend.no_site_root')}</h3>

					<div class="panel panel-default recordlist">
						<div class="table-fit">
							<table data-table="pages" class="table table-striped table-hover">
								<tbody>
								<f:for each="{pages}" as="page">
									<tr data-uid="{page.pid}">
										<td nowrap="nowrap" class="col-title">
											<f:link.action action="index" additionalParams="{id: page.uid}">
												<sg:backend.icon table="pages" row="{page}" clickMenu="0" />
												{page._thePathFull}
											</f:link.action>
										</td>
									</tr>
								</f:for>
								</tbody>
							</table>
						</div>
					</div>
				</f:then>
				<f:else>
					<div class="alert alert-warning" role="alert">
						{f:translate(key:'backend.no_site_root_found')}
					</div>
				</f:else>
			</f:if>
		</f:else>
	</f:if>
</f:section>
